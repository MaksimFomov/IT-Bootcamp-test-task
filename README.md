# Тестовое задание IT Bootcamp

## Описание

Этот проект представляет собой REST API, разработанный на базе Spring Boot, Hibernate и MySQL. Проект предоставляет эндпоинты для добавления пользователей и получения списка всех пользователей.

## Требования

### Обязательные требования:

- Многомодульный maven проект (3-level three-module development architecture).
- Система контроля версий – Git (Тестовый проект должен быть залит на GitHub и должен быть предоставлен к нему публичный доступ).
- Java 17+.
- Log4j2 как система логирования.
- Spring Boot 3 (или Tomcat 10 + Spring 6).
- Hibernate 6.
- MySQL 8.
- Формат: JSON 
- Архитектурный стиль: REST

### Опциональные требования:

- Использование Docker и Docker Compose для контейнеризации проекта.
- Unit и Integration тесты на приложение.
- Использование Liquibase/Flyway для миграции базы данных API.
- Обработка ошибок 
- Постраничный вывод записей по 10 для получения пользователя

## Зависимости

### Основные зависимости

Проект использует следующие основные зависимости:

- **Spring Boot**: Фреймворк для создания приложений на основе Spring с автоматической настройкой и управлением. Версия: 3.1.1.
- **Hibernate**: ORM-фреймворк для взаимодействия с базой данных. Версия: 6.0.0.
- **MySQL Connector/J**: Драйвер для подключения к базе данных MySQL. Версия: 8.0.33.
- **Log4j2**: Библиотека для логирования. Версия: 2.17.1.
- **Lombok**: Библиотека для генерации кода и уменьшения объема бойлерплейта. Версия: 1.18.26.
- **MapStruct**: Библиотека для преобразования между DTO и сущностями. Версия: 1.5.5.Final.
- **Jakarta Validation API**: API для валидации данных. Версия: 3.0.2.

### Зависимости для тестирования

Для тестирования проект использует следующие зависимости:

- **JUnit**: Фреймворк для модульного тестирования Java-приложений. Версия: 4.13.2.
- **Mockito**: Библиотека для создания заглушек и мок-объектов в тестах. Версия: 3.12.4.
- **Spring Boot Starter Test**: Зависимость для поддержки тестирования Spring Boot приложений. Версия: 3.1.1.

### Зависимости для миграции базы данных

Для миграции базы данных проект использует следующую зависимость:

- **Flyway MySQL**: Инструмент для управления миграциями базы данных.

### Зависимости для Docker

Если вы хотите использовать Docker для контейнеризации проекта, убедитесь, что Docker и Docker compose установлены на вашем компьютере.

## Требования для запуска 

Для успешного запуска проекта необходимо удостовериться, что ваша система удовлетворяет следующим требованиям:

1. Java Development Kit (JDK) 17 или выше должен быть установлен на вашем компьютере.
2. MySQL 8 сервер должен быть установлен и работающий.
3. Maven установлен на вашу систему.
4. Docker и Docker Compose, если вы хотите использовать контейнеризацию.

## Инструкция для запуска 

1. **Клонирование проекта**:

   Клонируйте репозиторий с проектом из репозитория GitHub:

   ```
   git clone https://github.com/MaksimFomov/IT-Bootcamp-test-task
   ```

2. **Установка зависимостей**:

   Перейдите в корневую директорию проекта:

   ```
   cd your_project
   ```

   Запустите команду для сборки проекта и установки зависимостей:

   ```
   mvn clean install
   ```

3. **Настройка базы данных**:

   Убедитесь, что у вас установлен и запущен сервер базы данных MySQL 8. Создайте базу данных с именем `your_database_name` (замените `your_database_name` на желаемое имя) и настройте доступ в модуле data в файле `application.properties`:

   ```
   spring.datasource.url=jdbc:mysql://localhost:3306/your_database_name
   spring.datasource.username=your_mysql_username
   spring.datasource.password=your_mysql_password
   ```

   Замените `your_database_name`, `your_mysql_username` и `your_mysql_password` на соответствующие значения.

4. **Запуск приложения**:

   Запустите приложение с помощью Maven:

   ```
   mvn spring-boot:run
   ```

   После успешного запуска, ваше REST API будет доступно по адресу `http://localhost:8080/`.

5. **Миграции базы данных**:

   Миграции базы данных применяются автоматически

## Инструкция для запуска через Docker:

### Подготовка перед созданием и запуском образа

Подготовка к запуску проекта с использованием Docker включает несколько шагов:

1. **Сборка JAR файла**: Прежде чем запускать приложение в Docker-контейнере, необходимо убедиться, что проект собран в исполняемый JAR файл. Для этого используйте команду сборки Maven, которая создаст JAR файл в директории проекта:

```
mvn clean package
```

После выполнения этой команды, JAR файл вашего проекта будет доступен в папке `target`.

2. **Настройка application.properties**: В файле `application.properties` вашего Spring Boot проекта, который находится в модуле data в папке `src/main/resources`, изменить url на:

```
spring.datasource.url=spring.datasource.url=jdbc:mysql://mysql-container:3306/your_database_name
```

Замените `your_database_name` на соответствующие значения вашей MySQL базы данных.

### Создание Docker-образа и запуск Docker-контейнеров в фоновом режиме:

   В корневой директории проекта выполните команду для сборки Docker-образа:

   ```
   docker-compose up -d --build
   ```

### Запуск Docker-контейнеров:

- Запуск в фоновом режиме

   ```
   docker-compose up -d
   ```

- Запуск в текущей командной строке

   ```
   docker-compose up
   ```

### Остановка Docker-контейнеров:

   При необходимости вы можете остановить:

   ```
   docker-compose stop
   ```

## Эндпоинты

### Endpoint для добавления пользователя:

- **URL**: `/users`
- **Метод**: POST
- **Описание**: Добавляет нового пользователя.
- **Формат данных**: JSON
- **Основные поля**:
    - Фамилия (40 символов, только латинские буквы).
    - Имя (20 символов, только латинские буквы).
    - Отчество (40 символов, только латинские буквы).
    - Email (50 символов, стандартный шаблон).
    - Role (ROLE_ADMINISTRATOR, ROLE_SALE_USER, ROLE_CUSTOMER_USER, ROLE_SECURE_API_USER).

### Endpoint для получения всех пользователей:

- **URL**: `/users`
- **Метод**: GET
- **Описание**: Постранично возвращает список всех пользователей по 10 записей, отсортированных по email в алфавитном порядке.
- **Формат данных**: JSON
- **Основные поля**:
    - ФИО (Фамилия, Имя, Отчество).
    - Email.
    - Role.

##  Примеры запросов
1. **Пример запроса на добавление нового пользователя**:

**URL**: POST /api/users

**Request Body** (в формате JSON):
```
{
  "firstName": "Maksim",
  "lastName": "Fomov",
  "middleName": "Aleksandrovich",
  "email": "maksimfomov26@gmail.com",
  "role": "ROLE_ADMINISTRATOR"
}
```

**Пример ответа** (в формате JSON), если пользователь успешно добавлен:
```
{
    "fullName": "Fomov Maksim Aleksandrovich",
    "email": "maksimfomov26@gmail.com",
    "role": "ROLE_ADMINISTRATOR"
}
```

2. **Пример запроса на получение всех пользователей**:

**URL**: GET /api/users

**Пример ответа** (в формате JSON), если есть пользователи в базе данных:
```
[
    {
        "fullName": "Smith Jane Doe",
        "email": "jane.smith@example.com",
        "role": "ROLE_SECURE_API_USER"
    },
    {
        "fullName": "Doe John Smith",
        "email": "john.doe@example.com",
        "role": "ROLE_SALE_USER"
    }
]
```

3. **Пример ошибки при добавлении пользователя**:

**URL**: POST /api/users

**Request Body** (в формате JSON) с неверными данными (например, отсутствует обязательное поле и превышина длина строки):
```
{
  "firstName": "",
  "lastName": "Fomov",
  "middleName": "jnrhebvuhrevgercgyvygrevcygrvcrecrcercrec",
  "email": "maksimfomov26@gmail.com",
  "role": "ROLE_ADMINISTRATOR"
}
```

**Пример ответа** (в формате JSON) с сообщением об ошибке:
```
First name is required
Middle name should not exceed 40 characters
```

## Инструкция по запуску тестов коллекции Postman

Чтобы запустить тесты коллекции Postman в данном проекте, выполните следующие шаги:

1. Убедитесь, что у вас установлен Postman на вашем компьютере. Если вы еще не установили Postman, вы можете скачать его с официального веб-сайта [Get Postman](https://www.postman.com/downloads/).

2. Откройте Postman на вашем компьютере.

3. В Postman выберите вкладку "Import" (Импорт) в верхнем левом углу.

4. Нажмите кнопку "Upload Files" (Загрузить файлы) и выберите файл коллекции Postman, который находится в папке postman в корне проекта.

5. После успешной загрузки коллекции Postman, она будет отображаться в списке коллекций в левой панели Postman.

6. Выберите коллекцию, содержащую тесты, которые вы хотите запустить.

7. Чтобы запустить тесты коллекции, нажмите кнопку "Runner" (Запуск).

8. В окне "Collection Runner" (Запуск коллекции) вы можете настроить параметры запуска тестов, такие как переменные окружения и данные. Убедитесь, что все настройки настроены правильно.

9. Нажмите кнопку "Start Run" (Запустить запуск) для начала выполнения тестов коллекции.

10. После выполнения тестов вы увидите результаты в окне "Collection Runner" и вкладке "Tests" (Тесты) внизу Postman.

## Заключение:

В ходе разработки тестового задания были успешно выполнены все предоставленные требования, как обязательные, так и опциональные. Проект представляет собой многомодульное приложение на базе Spring Boot, реализующее REST API API для управления пользователями.

**Выполненные обязательные требования:**
1. Многомодульный maven проект с 3-уровневой архитектурой (core, data, web).
2. Использование системы контроля версий Git с размещением проекта на GitHub и предоставлением публичного доступа.
3. Использование Java 17+ для разработки.
4. Логирование с помощью Log4j2.
5. Использование Spring Boot 3 и Hibernate 6.
6. Использование MySQL 8 в качестве базы данных.
7. Использование формата: JSON 
8. Использование архитектурного стиля: REST

**Выполненные опциональные требования:**
1. Контейнеризация проекта с помощью Docker и Docker Compose.
2. Написание Unit тестов для приложения.
3. Использование Flyway для миграции базы данных API. 
4. Обработка ошибок 
5. Постраничный вывод записей по 10 для получения пользователя

Проект успешно прошел тестирование и демонстрирует работоспособность, а также соответствие заданным требованиям.